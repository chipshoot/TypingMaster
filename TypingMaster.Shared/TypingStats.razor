@using TypingMaster.Core.Models

<div class="typing-stats @Class">
    <div class="stat-item">
        <div class="stat-label">
            <i class="fas fa-tachometer-alt"></i>
            <span>WPM</span>
        </div>
        <div class="stat-value">@Wpm</div>
    </div>
    <div class="stat-item">
        <div class="stat-label">
            <i class="fas fa-bullseye"></i>
            <span>Accuracy</span>
        </div>
        <div class="stat-value">@($"{Accuracy:F1}%")</div>
    </div>
    @if (ShowLevel)
    {
        <div class="stat-item">
            <div class="stat-label">
                <i class="fas fa-chart-line"></i>
                <span>Level</span>
            </div>
            <div class="stat-value">@Level.ToString()</div>
        </div>
    }
    @if (ShowDuration)
    {
        <div class="stat-item">
            <div class="stat-label">
                <i class="fas fa-clock"></i>
                <span>Duration</span>
            </div>
            <div class="stat-value">@FormattedDuration</div>
        </div>
    }
</div>

<style>
    .typing-stats {
        display: flex;
        gap: 1.5rem;
        padding: 0.5rem 1rem;
        background: var(--bs-body-bg);
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .typing-stats.compact {
        padding: 0.25rem 0.75rem;
        gap: 1rem;
    }

    .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-width: 80px;
    }

    .stat-label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--bs-secondary);
        font-size: 0.875rem;
    }

    .stat-value {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--bs-primary);
    }

    .compact .stat-value {
        font-size: 1.1rem;
    }

    .compact .stat-label {
        font-size: 0.8rem;
    }
</style>

@code {
    [Parameter]
    public int Wpm { get; set; }

    [Parameter]
    public double Accuracy { get; set; }

    [Parameter]
    public bool ShowLevel { get; set; } = true;

    [Parameter]
    public bool ShowDuration { get; set; } = false;

    [Parameter]
    public long PracticeDurationSeconds { get; set; } = 0;

    [Parameter]
    public string Class { get; set; } = "";

    private SkillLevel Level => (Wpm, Accuracy).GetSkillLevel();

    private string FormattedDuration
    {
        get
        {
            if (PracticeDurationSeconds <= 0)
                return "0s";

            var timeSpan = TimeSpan.FromSeconds(PracticeDurationSeconds);

            if (timeSpan.TotalDays >= 1)
            {
                return $"{(int)timeSpan.TotalDays}d {timeSpan.Hours}h {timeSpan.Minutes}m";
            }
            else if (timeSpan.TotalHours >= 1)
            {
                return $"{timeSpan.Hours}h {timeSpan.Minutes}m {timeSpan.Seconds}s";
            }
            else if (timeSpan.TotalMinutes >= 1)
            {
                return $"{timeSpan.Minutes}m {timeSpan.Seconds}s";
            }
            else
            {
                return $"{timeSpan.Seconds}s";
            }
        }
    }
}